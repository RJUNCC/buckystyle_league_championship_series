[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,542 - discord.client - WARNING - PyNaCl is not installed, voice will NOT be supported
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,545 - __main__ - INFO - üè• Health check server task created
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,546 - __main__ - INFO - üîÑ Initializing database connection...
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,546 - models.database_config - INFO - ‚úÖ Configured PostgreSQL database engine
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,657 - models.database_config - INFO - ‚úÖ Database connection successful
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,659 - models.database_config - INFO - üìä PostgreSQL Version: PostgreSQL 17.5 on x86_64-pc-linux-gnu, compiled b...
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,685 - models.database_config - INFO - ‚úÖ Database tables created/verified
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,713 - models.database_config - INFO - üìã Tables in database: blcs_player_mappings, blcs_player_statistics, player_profiles, scheduling_sessions
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,716 - __main__ - INFO - üîß Checking for database migrations...
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,747 - __main__ - INFO - ‚úÖ Database schema is up to date
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,750 - __main__ - INFO - ‚úÖ PostgreSQL database initialized successfully
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,750 - __main__ - INFO - üìä Connected to PostgreSQL: discord-bot-postgresql-do-user-16248210-0.m.db.ondigitalocean.com:25060
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,750 - __main__ - INFO - ‚úÖ BLCSX ballchasing integration initialized
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,750 - __main__ - INFO -    üéÆ BLCSX Stats commands available:
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,750 - __main__ - INFO -    /blcs_profile - Comprehensive player profiles
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,750 - __main__ - INFO -    /blcs_leaderboard - Dominance quotient rankings
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,751 - __main__ - INFO -    /blcs_link - Link ballchasing.com account
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,751 - __main__ - INFO -    /blcs_update - Update stats (admin only)
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,751 - __main__ - INFO - ‚úÖ Traditional ballchasing integration initialized
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,753 - __main__ - INFO - ‚úÖ Loaded cog: DraftLotteryCog
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,901 - cogs.blcsx_stats - INFO - PostgreSQL database initialized for BLCS stats
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,902 - cogs.blcsx_stats - INFO - BLCSX Stats Cog initialized
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,904 - __main__ - INFO - ‚úÖ Loaded cog: BLCSXStatsCog
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,904 - __main__ - INFO - üöÄ Starting Discord bot...
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,904 - discord.client - INFO - logging in using static token
[bot] [2025-07-03 03:46:30] 2025-07-03 03:46:30,921 - __main__ - INFO - ‚úÖ Health check server started on port 8080
[bot] [2025-07-03 03:46:31] 2025-07-03 03:46:31,226 - discord.gateway - INFO - Shard ID None has sent the IDENTIFY payload.
[bot] [2025-07-03 03:46:31] 2025-07-03 03:46:31,317 - discord.gateway - INFO - Shard ID None has connected to Gateway: ["gateway-prd-us-east1-b-g5tp",{"micros":63991,"calls":["id_created",{"micros":415,"calls":[]},"session_lookup_time",{"micros":269,"calls":[]},"session_lookup_finished",{"micros":12,"calls":[]},"discord-sessions-prd-2-148",{"micros":62917,"calls":["start_session",{"micros":51689,"calls":["discord-api-rpc-bdd745bbd-wwtjc",{"micros":38216,"calls":["get_user",{"micros":5944},"get_guilds",{"micros":4387},"send_scheduled_deletion_message",{"micros":16},"guild_join_requests",{"micros":342},"authorized_ip_coro",{"micros":14},"pending_payments",{"micros":5641},"apex_experiments",{"micros":718},"user_activities",{"micros":3},"played_application_ids",{"micros":2}]}]},"starting_guild_connect",{"micros":22,"calls":[]},"presence_started",{"micros":10711,"calls":[]},"guilds_started",{"micros":126,"calls":[]},"lobbies_started",{"micros":1,"calls":[]},"guilds_connect",{"micros":1,"calls":[]},"presence_connect",{"micros":339,"calls":[]},"connect_finished",{"micros":343,"calls":[]},"build_ready",{"micros":11,"calls":[]},"clean_ready",{"micros":1,"calls":[]},"optimize_ready",{"micros":0,"calls":[]},"split_ready",{"micros":12,"calls":[]}]}]}] (Session ID: c37059d33031b1b28496be89b967d4c2).
[bot] [2025-07-03 03:46:33] 2025-07-03 03:46:33,338 - __main__ - INFO - ‚úÖ BLCS Bot#6695 has connected to Discord!
[bot] [2025-07-03 03:46:33] 2025-07-03 03:46:33,338 - __main__ - INFO - üìä Connected to 2 servers
[bot] [2025-07-03 03:46:33] 2025-07-03 03:46:33,338 - __main__ - INFO - ‚úÖ Slash commands auto-synced by py-cord
[bot] [2025-07-03 03:48:32] Ignoring exception in command schedule_game:
[bot] [2025-07-03 03:48:32] Traceback (most recent call last):
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
[bot] [2025-07-03 03:48:32]     self.dialect.do_execute(
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
[bot] [2025-07-03 03:48:32]     cursor.execute(statement, parameters)
[bot] [2025-07-03 03:48:32] psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "ix_scheduling_sessions_channel_id"
[bot] [2025-07-03 03:48:32] DETAIL:  Key (channel_id)=(1388346880865599578) already exists.
[bot] [2025-07-03 03:48:32] 
[bot] [2025-07-03 03:48:32] 
[bot] [2025-07-03 03:48:32] The above exception was the direct cause of the following exception:
[bot] [2025-07-03 03:48:32] 
[bot] [2025-07-03 03:48:32] Traceback (most recent call last):
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/discord/commands/core.py", line 138, in wrapped
[bot] [2025-07-03 03:48:32]     ret = await coro(arg)
[bot] [2025-07-03 03:48:32]           ^^^^^^^^^^^^^^^
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/discord/commands/core.py", line 1078, in _invoke
[bot] [2025-07-03 03:48:32]     await self.callback(self.cog, ctx, **kwargs)
[bot] [2025-07-03 03:48:32]   File "/app/cogs/draft_prob.py", line 1063, in schedule_game
[bot] [2025-07-03 03:48:32]     save_session(new_session_obj)
[bot] [2025-07-03 03:48:32]   File "/app/models/scheduling.py", line 213, in save_session
[bot] [2025-07-03 03:48:32]     db.commit()
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
[bot] [2025-07-03 03:48:32]     trans.commit(_to_root=True)
[bot] [2025-07-03 03:48:32]   File "<string>", line 2, in commit
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
[bot] [2025-07-03 03:48:32]     ret_value = fn(self, *arg, **kw)
[bot] [2025-07-03 03:48:32]                 ^^^^^^^^^^^^^^^^^^^^
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
[bot] [2025-07-03 03:48:32]     self._prepare_impl()
[bot] [2025-07-03 03:48:32]   File "<string>", line 2, in _prepare_impl
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
[bot] [2025-07-03 03:48:32]     ret_value = fn(self, *arg, **kw)
[bot] [2025-07-03 03:48:32]                 ^^^^^^^^^^^^^^^^^^^^
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
[bot] [2025-07-03 03:48:32]     self.session.flush()
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
[bot] [2025-07-03 03:48:32]     self._flush(objects)
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
[bot] [2025-07-03 03:48:32]     with util.safe_reraise():
[bot] [2025-07-03 03:48:32]          ^^^^^^^^^^^^^^^^^^^
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
[bot] [2025-07-03 03:48:32]     raise exc_value.with_traceback(exc_tb)
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
[bot] [2025-07-03 03:48:32]     flush_context.execute()
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
[bot] [2025-07-03 03:48:32]     rec.execute(self)
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
[bot] [2025-07-03 03:48:32]     util.preloaded.orm_persistence.save_obj(
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
[bot] [2025-07-03 03:48:32]     _emit_insert_statements(
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
[bot] [2025-07-03 03:48:32]     result = connection.execute(
[bot] [2025-07-03 03:48:32]              ^^^^^^^^^^^^^^^^^^^
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
[bot] [2025-07-03 03:48:32]     return meth(
[bot] [2025-07-03 03:48:32]            ^^^^^
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
[bot] [2025-07-03 03:48:32]     return connection._execute_clauseelement(
[bot] [2025-07-03 03:48:32]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
[bot] [2025-07-03 03:48:32]     ret = self._execute_context(
[bot] [2025-07-03 03:48:32]           ^^^^^^^^^^^^^^^^^^^^^^
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
[bot] [2025-07-03 03:48:32]     return self._exec_single_context(
[bot] [2025-07-03 03:48:32]            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
[bot] [2025-07-03 03:48:32]     self._handle_dbapi_exception(
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
[bot] [2025-07-03 03:48:32]     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
[bot] [2025-07-03 03:48:32]     self.dialect.do_execute(
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
[bot] [2025-07-03 03:48:32]     cursor.execute(statement, parameters)
[bot] [2025-07-03 03:48:32] sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "ix_scheduling_sessions_channel_id"
[bot] [2025-07-03 03:48:32] DETAIL:  Key (channel_id)=(1388346880865599578) already exists.
[bot] [2025-07-03 03:48:32] 
[bot] [2025-07-03 03:48:32] [SQL: INSERT INTO scheduling_sessions (channel_id, team1, team2, player_schedules, players_responded, expected_players, created_at, schedule_dates, confirmations, is_active, proposed_times) VALUES (%(channel_id)s, %(team1)s, %(team2)s, %(player_schedules)s::JSON, %(players_responded)s::JSON, %(expected_players)s, %(created_at)s, %(schedule_dates)s::JSON, %(confirmations)s::JSON, %(is_active)s, %(proposed_times)s::JSON) RETURNING scheduling_sessions.id]
[bot] [2025-07-03 03:48:32] [parameters: {'channel_id': '1388346880865599578', 'team1': 't1', 'team2': 't2', 'player_schedules': '{}', 'players_responded': '[]', 'expected_players': 6, 'created_at': datetime.datetime(2025, 7, 3, 3, 48, 32, 429155), 'schedule_dates': '[{"day_name": "Thursday", "date": "07/03", "full_date": "Thursday, July 03"}, {"day_name": "Friday", "date": "07/04", "full_date": "Friday, July 04"} ... (229 characters truncated) ... y_name": "Tuesday", "date": "07/08", "full_date": "Tuesday, July 08"}, {"day_name": "Wednesday", "date": "07/09", "full_date": "Wednesday, July 09"}]', 'confirmations': '{}', 'is_active': True, 'proposed_times': '[]'}]
[bot] [2025-07-03 03:48:32] (Background on this error at: https://sqlalche.me/e/20/gkpj)
[bot] [2025-07-03 03:48:32] 
[bot] [2025-07-03 03:48:32] The above exception was the direct cause of the following exception:
[bot] [2025-07-03 03:48:32] 
[bot] [2025-07-03 03:48:32] Traceback (most recent call last):
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/discord/bot.py", line 1137, in invoke_application_command
[bot] [2025-07-03 03:48:32]     await ctx.command.invoke(ctx)
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/discord/commands/core.py", line 435, in invoke
[bot] [2025-07-03 03:48:32]     await injected(ctx)
[bot] [2025-07-03 03:48:32]   File "/usr/local/lib/python3.12/site-packages/discord/commands/core.py", line 146, in wrapped
[bot] [2025-07-03 03:48:32]     raise ApplicationCommandInvokeError(exc) from exc
[bot] [2025-07-03 03:48:32] discord.errors.ApplicationCommandInvokeError: Application Command raised an exception: IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "ix_scheduling_sessions_channel_id"
[bot] [2025-07-03 03:48:32] DETAIL:  Key (channel_id)=(1388346880865599578) already exists.
[bot] [2025-07-03 03:48:32] 
[bot] [2025-07-03 03:48:32] [SQL: INSERT INTO scheduling_sessions (channel_id, team1, team2, player_schedules, players_responded, expected_players, created_at, schedule_dates, confirmations, is_active, proposed_times) VALUES (%(channel_id)s, %(team1)s, %(team2)s, %(player_schedules)s::JSON, %(players_responded)s::JSON, %(expected_players)s, %(created_at)s, %(schedule_dates)s::JSON, %(confirmations)s::JSON, %(is_active)s, %(proposed_times)s::JSON) RETURNING scheduling_sessions.id]
[bot] [2025-07-03 03:48:32] [parameters: {'channel_id': '1388346880865599578', 'team1': 't1', 'team2': 't2', 'player_schedules': '{}', 'players_responded': '[]', 'expected_players': 6, 'created_at': datetime.datetime(2025, 7, 3, 3, 48, 32, 429155), 'schedule_dates': '[{"day_name": "Thursday", "date": "07/03", "full_date": "Thursday, July 03"}, {"day_name": "Friday", "date": "07/04", "full_date": "Friday, July 04"} ... (229 characters truncated) ... y_name": "Tuesday", "date": "07/08", "full_date": "Tuesday, July 08"}, {"day_name": "Wednesday", "date": "07/09", "full_date": "Wednesday, July 09"}]', 'confirmations': '{}', 'is_active': True, 'proposed_times': '[]'}]
[bot] [2025-07-03 03:48:32] (Background on this error at: https://sqlalche.me/e/20/gkpj)